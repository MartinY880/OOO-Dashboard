# ========================================
# Appwrite Configuration
# ========================================
APPWRITE_ENDPOINT=https://cloud.appwrite.io/v1
APPWRITE_PROJECT_ID=your-project-id-here
APPWRITE_API_KEY=your-api-key-here

# ========================================
# Authentication Strategy
# ========================================
# Options: 'msal' (recommended) or 'appwrite-oauth'
AUTH_STRATEGY=msal

# NextAuth Secret (generate with: openssl rand -base64 32)
NEXTAUTH_SECRET=your-nextauth-secret-here
NEXTAUTH_URL=http://localhost:3000

# ========================================
# Azure AD (Entra ID) Configuration
# ========================================
AZURE_TENANT_ID=xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
AZURE_CLIENT_ID=xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
AZURE_CLIENT_SECRET=your-client-secret-here
AZURE_REDIRECT_URI=http://localhost:3000/api/auth/callback/azure-ad

# Microsoft Graph Scopes (space-separated)
GRAPH_SCOPES="openid profile email offline_access User.Read MailboxSettings.ReadWrite Mail.ReadWrite"

# ========================================
# Execution Mode
# ========================================
# Options: 'graph' (direct Microsoft Graph) or 'n8n' (webhook)
EXECUTION_MODE=graph

# ========================================
# n8n Webhook Configuration
# ========================================
N8N_WEBHOOK_URL=https://your-n8n-instance.app.n8n.cloud/webhook/office365-actions
N8N_SIGNATURE_SECRET=change-me-to-random-string

# ========================================
# Security Settings
# ========================================
# 32-byte encryption key for refresh tokens (generate with node -e "console.log(require('crypto').randomBytes(32).toString('base64'))")
ENCRYPTION_KEY_32B_BASE64=generate-with-openssl-rand-base64-32

# Allow forwarding to external domains (outside user's domain)
ALLOW_EXTERNAL_FORWARDING=false

# ========================================
# Optional: Application Settings
# ========================================
NODE_ENV=development
